rep = [54468	112197	16239	113330	68781	39676	59915	187314	6195	71788	56607	50931	67163	43333	51426	20057	46283	45110	54043	23177	40072	64222	29003	72126	19803	26208	52499	106742	103738	242948];
position = [37.64 -77.68
40.01 -75.13
41.76 -81.72
40.84 -75.46
39.76 -84.29
40.06 -83.53
39.40 -83.27
40.47 -79.98
39.63 -79.23
39.16 -78.77
37.95 -84.67
37.32 -78.80
39.85 -79.19
39.20 -84.54
40.84 -77.70
38.02 -83.15
40.10 -82.80
38.76 -77.72
39.92 -75.40
38.69 -78.53
38.61 -81.75
37.41 -86.37
39.86 -80.73
39.23 -77.67
39.76 -82.14
40.53 -79.88
39.77 -82.86
39.97 -83.01
40.34 -80.20
40.23 -82.14];
total = [63	58	65	72	47	141	285	55	41	75	78	106	158	8	14	24	17	27	19	4	13	21	59	54	83	18	12	61	263	218	234	333	68	42	3	164	145	137	138	162	127	133	46	51	95	165	1	43	9	144	15	16	110	7	26	31	36	5411	2412	2713	1414	1215	1916	4717	62	82	57	53	23	1918	126	93	15819	122	88	92	5320	5521	44	52	6222	2723	1924	1725	30	2426	66	128	1229	1230	2331	103	60	227	117	231	114	10632	121	148	188	371	233	345	205	139	12833	185	208	142	190	105	168	125	5334	159	5435	5236	3137	89	100	129	241	87	5938	2439	6040	6141	9342	12243	10	32	1344	175	11045	79	124	91	6546	6547	9248	8749	98	149	1950	67	4751	76	71	85	10652	34	136	134	90	102	196	211	221	14253	140	280	289	503	482	540	536	278	35	4154	4455	48	2656	957	1758	167	151	330	199	19659	187	97	8860	8861	146	203	16462	184	45	6263	8564	12765	15166	2667	1868	33	16269	21170	214	315	16771	6672	38	605	752	1008	1073	1205	947	1069];
tspan = [1,2,3,4,5,6,7];
class = 1:30;
I = 1:30;
for ind = 1:1:30
    I(ind) = funi(ind,1,total,rep);
end

for a = 0.001:0.001:0.1
    for b = 0.001:0.001:0.1
        for c = 0.1:0.1:10
            [T,Y] = ode45(odefun,tspan,I,[],a,b,c,rep,position);
       end
    end
end

function i = funi(k,j,total,rep)
i = total(1,(k - 1) * 7 + j) / (15 * rep(1,k));
end

function r = funr(i,j,position)
r = sqrt((position(i,1) - position(i,1)) ^ 2 + (position(i,2) - position(i,2)) ^ 2);
end
function w = funw(i,j,rep)
w = rep(i) / rep(j);
end
function dy=odefun(t,y,alpha,lambda,beta,rep,position)
    dy = zeros(30,1);
    for index = 1:30
        dy(index) = lambda * funt(y,index,rep,beta,position) * (1 - y(index)) - alpha * y(index);
    end
    function theta = funt(y,k,rep,beta,position)
    denominator = 0;
    for indx = 1:30
        denominator = denominator + funw(indx,k,rep) * exp(-1 * beta * funr(indx,k,position));
    end
    theta = 0;
    for indx = 1:30
        theta = theta + y(indx) * funw(indx,k,rep) * exp(-1 * beta * funr(indx,k,position));
    end
end
end